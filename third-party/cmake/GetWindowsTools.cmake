# Download and install third party tools for windows

ExternalProject_Add(diffutils
  PREFIX ${DEPS_BUILD_DIR}
  URL ${DIFFUTILS_URL}
  DOWNLOAD_DIR ${DEPS_DOWNLOAD_DIR}
  DOWNLOAD_COMMAND ${CMAKE_COMMAND}
    -DPREFIX=${DEPS_BUILD_DIR}
    -DDOWNLOAD_DIR=${DEPS_DOWNLOAD_DIR}
    -DURL=${DIFFUTILS_URL}
    -DEXPECTED_SHA256=${DIFFUTILS_SHA256}
    -DTARGET=diffutils
    -DUSE_EXISTING_SRC_DIR=${USE_EXISTING_SRC_DIR}
    -P ${CMAKE_CURRENT_SOURCE_DIR}/cmake/DownloadAndExtractFile.cmake
  CONFIGURE_COMMAND ""
  BUILD_IN_SOURCE 1
  CONFIGURE_COMMAND ""
  BUILD_COMMAND ""
  INSTALL_COMMAND ${CMAKE_COMMAND} -E make_directory ${DEPS_INSTALL_DIR}/bin
    COMMAND ${CMAKE_COMMAND} -E copy ${DEPS_BUILD_DIR}/src/diffutils/bin/diff.exe ${DEPS_INSTALL_DIR}/bin)
list(APPEND THIRD_PARTY_DEPS diffutils)

ExternalProject_Add(libintl3
  PREFIX ${DEPS_BUILD_DIR}
  URL ${LIBINTL3_URL}
  DOWNLOAD_DIR ${DEPS_DOWNLOAD_DIR}
  DOWNLOAD_COMMAND ${CMAKE_COMMAND}
    -DPREFIX=${DEPS_BUILD_DIR}
    -DDOWNLOAD_DIR=${DEPS_DOWNLOAD_DIR}
    -DURL=${LIBINTL3_URL}
    -DEXPECTED_SHA256=${LIBINTL3_SHA256}
    -DTARGET=libintl3
    -DUSE_EXISTING_SRC_DIR=${USE_EXISTING_SRC_DIR}
    -P ${CMAKE_CURRENT_SOURCE_DIR}/cmake/DownloadAndExtractFile.cmake
  CONFIGURE_COMMAND ""
  BUILD_IN_SOURCE 1
  CONFIGURE_COMMAND ""
  BUILD_COMMAND ""
  INSTALL_COMMAND ${CMAKE_COMMAND} -E make_directory ${DEPS_INSTALL_DIR}/bin
    COMMAND ${CMAKE_COMMAND} -E copy ${DEPS_BUILD_DIR}/src/libintl3/bin/libintl3.dll ${DEPS_INSTALL_DIR}/bin)
list(APPEND THIRD_PARTY_DEPS libintl3)

ExternalProject_Add(libiconv2
  PREFIX ${DEPS_BUILD_DIR}
  URL ${LIBICONV2_URL}
  DOWNLOAD_DIR ${DEPS_DOWNLOAD_DIR}
  DOWNLOAD_COMMAND ${CMAKE_COMMAND}
    -DPREFIX=${DEPS_BUILD_DIR}
    -DDOWNLOAD_DIR=${DEPS_DOWNLOAD_DIR}
    -DURL=${LIBICONV2_URL}
    -DEXPECTED_SHA256=${LIBICONV2_SHA256}
    -DTARGET=libiconv2
    -DUSE_EXISTING_SRC_DIR=${USE_EXISTING_SRC_DIR}
    -P ${CMAKE_CURRENT_SOURCE_DIR}/cmake/DownloadAndExtractFile.cmake
  CONFIGURE_COMMAND ""
  BUILD_IN_SOURCE 1
  CONFIGURE_COMMAND ""
  BUILD_COMMAND ""
  INSTALL_COMMAND ${CMAKE_COMMAND} -E make_directory ${DEPS_INSTALL_DIR}/bin
    COMMAND ${CMAKE_COMMAND} -E copy ${DEPS_BUILD_DIR}/src/libiconv2/bin/libiconv2.dll ${DEPS_INSTALL_DIR}/bin)
list(APPEND THIRD_PARTY_DEPS libiconv2)

ExternalProject_Add(winclip
  PREFIX ${DEPS_BUILD_DIR}
  URL ${WINCLIP_URL}
  DOWNLOAD_DIR ${DEPS_DOWNLOAD_DIR}
  DOWNLOAD_COMMAND ${CMAKE_COMMAND}
    -DPREFIX=${DEPS_BUILD_DIR}
    -DDOWNLOAD_DIR=${DEPS_DOWNLOAD_DIR}
    -DURL=${WINCLIP_URL}
    -DEXPECTED_SHA256=${WINCLIP_SHA256}
    -DTARGET=winclip
    -DUSE_EXISTING_SRC_DIR=${USE_EXISTING_SRC_DIR}
    -P ${CMAKE_CURRENT_SOURCE_DIR}/cmake/DownloadAndExtractFile.cmake
  CONFIGURE_COMMAND ""
  BUILD_IN_SOURCE 1
  CONFIGURE_COMMAND ""
  BUILD_COMMAND ""
  INSTALL_COMMAND ${CMAKE_COMMAND} -E make_directory ${DEPS_INSTALL_DIR}/bin
    COMMAND ${CMAKE_COMMAND} -E copy 
             ${DEPS_BUILD_DIR}/src/winclip/bin/winclip.exe
	     ${DEPS_INSTALL_DIR}/bin)
list(APPEND THIRD_PARTY_DEPS winclip)
